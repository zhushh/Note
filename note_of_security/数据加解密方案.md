### 为什么需要数据加解密？

为了安全。

如何保证数据安全？

1. 保证传输的数据是经过加密或者编码过的，即使有人通过抓包软件抓取数据，也看不懂或者很难解开
2. 要能够确定收到的数据没有经过修改，也就是确认发送者身份



### 加解密算法

#### 对称加密

加密和解密使用同一个密钥的加密方式。

-  优点：加密计算量小，速度快，适合对大量数据进行加密场景
- 缺点：密钥传输问题和密钥管理问题

例子：**AES加密算法**



#### 非对称加密

非对称加密，是指需要用一对密钥，即公钥和私钥来完成加解密的方式。

如果用公钥加密，则只能使用私钥才能解密；如果用私钥加密，则只能使用公钥才能解密。

主要是为了解决**密钥传输问题**和**密钥管理问题**提出的。

- 优点：无需关心密钥的传输问题，只要在服务端管理好私钥即可
- 缺点：加密速度慢，对加密数据长度有限制

例子：**RSA加密算法**



### 加密方案选择

#### 方案一 Base64编码

base64编码不算加密，只是把字符经过编码变成不可读一串文字。



#### 方案二 约定密码，AES加密

服务端和客户端约定密码，两端保留，处理数据时使用约定的密码进行加解密。



#### 方案三 AES加密，密码随机生成

服务端随机生成密码，传输数据的时候把随机密码传输给对方，很蠢。



#### 方案四 RSA结合AES进行加密，对服务端的单向认证

1. 服务端生成一对RSA秘钥，私钥放在服务端，公钥下发给客户端
2. 服务端随机生成AES加密的key
3. 服务端使用随机key对传输的数据进行AES加密
4. 使用服务端的私钥对生成的key进行加密
5. 服务端将使用AES加密的数据以及使用RSA加密的随机key一起发给客户端
6. 客户端拿到数据后，先使用公钥对加密的key进行解密，解密成功即可使用key对加密数据进行AES解密

实现了服务端单向认证，传输的数据进行了加密。



#### 方案五 RSA结合AES，实现双向验证

如果服务端需要对客户端进行验证，那怎么办? 在方案四基础上，采用双向验证

1. 两端均生成一对RSA秘钥，各自保管私钥，把公钥发给对方
2. 客户端使用随机函数生成AES加密要使用的key
3. 客户端使用随机key对要传输数据进行AES加密
4. 客户端使用私钥对随机生成的key进行加密
5. 客户端将使用AES加密的数据以及使用客户端私钥加密的随机key一起发给服务端
6. 服务端拿到数据后，先使用客户端提供的公钥对加密的随机key进行解密，然后使用key对加密数据进行AES解密，获得最终数据



### openssl库实现rsa接口

rsa加密的public key格式有多种，常见的两种为：

1. **PKCS#1**：`-----BEGIN RSA PUBLIC KEY-----`
2. **PKCS#8**：`-----BEGIN PUBLIC KEY-----`

这两中格式，分别使用以下接口进行读取key：

1. PEM_read_bio_RSAPublicKey

2. PEM_read_bio_RSA_PUBKEY



### 参考

[常用加密算法概述](https://www.cnblogs.com/colife/p/5566789.html)

[浅谈常见的七种加密算法及实现](https://blog.csdn.net/baidu_22254181/article/details/82594072)

[MD5算法和SHA-1算法](https://www.jianshu.com/p/38c93c677124)

[对称加密及AES加密算法](https://www.jianshu.com/p/3840b344b27c)

[从支付宝SDK的支付流程理解什么是公钥和私钥，什么是加密和数字签名](https://www.jianshu.com/p/6f5f0695d8fa)

[非对称加密及RSA加密算法](https://www.jianshu.com/p/9785bd492a6e)

[网络传输数据加解密方案选择（RSA+AES）](https://blog.csdn.net/yuzhiqiang_1993/article/details/88641265)

[C/C++使用openssl进行摘要和加密解密（md5, sha256, des, rsa）](https://blog.csdn.net/u012234115/article/details/72762045)

[openssl库实现rsa加解密之PEM_read_bio_RSAPublicKey和PEM_read_bio_RSA_PUBKEY](https://blog.csdn.net/freesonWANG/article/details/87717361)